<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ÂÄã‰∫∫ÈÄ≤Â∫¶ËøΩËπ§</title>
<style>
:root {
    --bg: #F3F5FA;
    --card: #FFFFFF;
    --text-1: #1A1D2E;
    --text-2: #8C91A5;
    --text-3: #C0C5D2;
    --accent: #5B6CF0;
    --accent-light: #ECEFFE;
    --green: #34C759;
    --green-light: #E8FAF0;
    --ring-track: #E8EBF2;
    --shadow: 0 2px 16px rgba(26, 29, 46, 0.06);
    --shadow-sm: 0 1px 6px rgba(26, 29, 46, 0.04);
    --r: 16px;
    --r-sm: 12px;
}
* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
html, body { height: 100%; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    background: var(--bg);
    color: var(--text-1);
    line-height: 1.5;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
}
.app {
    max-width: 480px;
    margin: 0 auto;
    padding: 20px 20px calc(40px + env(safe-area-inset-bottom, 20px));
}

/* ===== Header ===== */
.header {
    text-align: center;
    margin-bottom: 28px;
}
.header-top {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    margin-bottom: 10px;
}
.header-title {
    font-size: 17px;
    font-weight: 700;
    color: var(--text-1);
    letter-spacing: 0.3px;
}
.date-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    margin-bottom: 12px;
}
.date-text {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-2);
}
.day-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.25s ease;
    user-select: none;
}
.day-chip.work {
    background: var(--accent-light);
    color: var(--accent);
}
.day-chip.rest {
    background: #FEF3C7;
    color: #D97706;
}
.day-chip:active { transform: scale(0.95); }

/* ===== Progress Ring ===== */
.progress-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 32px;
}
.ring-container {
    position: relative;
    width: 180px;
    height: 180px;
    margin-bottom: 4px;
}
.ring-svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}
.ring-track {
    fill: none;
    stroke: var(--ring-track);
    stroke-width: 10;
    stroke-linecap: round;
}
.ring-fill {
    fill: none;
    stroke: var(--accent);
    stroke-width: 10;
    stroke-linecap: round;
    transition: stroke-dashoffset 0.7s cubic-bezier(0.4, 0, 0.2, 1);
}
.ring-fill.complete { stroke: var(--green); }
.ring-center {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
}
.ring-pct {
    font-size: 36px;
    font-weight: 800;
    color: var(--text-1);
    line-height: 1.1;
}
.ring-pct.complete { color: var(--green); }
.ring-label {
    font-size: 13px;
    color: var(--text-2);
    font-weight: 500;
    margin-top: 2px;
}

/* ===== Category Cards ===== */
.cards {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.card {
    background: var(--card);
    border-radius: var(--r);
    box-shadow: var(--shadow);
    overflow: hidden;
    transition: box-shadow 0.25s ease;
}
.card:active { box-shadow: var(--shadow-sm); }
.card-header {
    display: flex;
    align-items: center;
    padding: 16px 18px;
    cursor: pointer;
    user-select: none;
    gap: 14px;
}
.card-icon {
    width: 42px;
    height: 42px;
    border-radius: var(--r-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    flex-shrink: 0;
}
.card-info {
    flex: 1;
    min-width: 0;
}
.card-name {
    font-size: 15px;
    font-weight: 600;
    color: var(--text-1);
    margin-bottom: 6px;
}
.card-bar-track {
    height: 5px;
    background: var(--ring-track);
    border-radius: 3px;
    overflow: hidden;
}
.card-bar-fill {
    height: 100%;
    border-radius: 3px;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    min-width: 0;
}
.card-right {
    display: flex;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
}
.card-count {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-2);
}
.card-count.done { color: var(--green); }
.card-chevron {
    width: 20px;
    height: 20px;
    color: var(--text-3);
    transition: transform 0.3s ease;
    flex-shrink: 0;
}
.card-chevron.open { transform: rotate(180deg); }

/* ===== Checklist ===== */
.card-body {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.35s cubic-bezier(0.4, 0, 0.2, 1);
}
.card-body.open {
    max-height: 600px;
}
.checklist {
    padding: 0 18px 16px;
}
.check-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 11px 0;
    cursor: pointer;
    user-select: none;
    border-bottom: 1px solid #F0F1F5;
}
.check-item:last-child { border-bottom: none; }
.check-box {
    width: 24px;
    height: 24px;
    border-radius: 7px;
    border: 2px solid var(--text-3);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    transition: all 0.2s ease;
}
.check-box.checked {
    border-color: transparent;
    transform: scale(1.05);
}
.check-box svg {
    width: 14px;
    height: 14px;
    opacity: 0;
    transform: scale(0.5);
    transition: all 0.2s ease;
}
.check-box.checked svg {
    opacity: 1;
    transform: scale(1);
}
.check-text {
    font-size: 14px;
    font-weight: 500;
    color: var(--text-1);
    transition: all 0.25s ease;
}
.check-text.done {
    color: var(--text-3);
    text-decoration: line-through;
}

/* ===== Celebration ===== */
.celebrate {
    text-align: center;
    padding: 24px 0 8px;
    animation: fadeIn 0.5s ease;
}
.celebrate-emoji { font-size: 36px; margin-bottom: 8px; }
.celebrate-text { font-size: 15px; font-weight: 600; color: var(--green); }

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
</head>
<body>
<div class="app" id="app"></div>
<script>
// ===== Data =====
const CATEGORIES = {
    work: [
        { id: "act", name: "Ê≠£Âøµ ACT", icon: "üß†", color: "#8B5CF6", bg: "#F3F0FF",
          items: ["Êó©Êô®ÂÜ•ÊÉ≥ 5 ÂàÜÈêò", "ACT Êé•Á¥çÁ∑¥Áøí", "ÂÉπÂÄºËßÄÂèçÊÄù", "Ë™çÁü•Ëß£Èõ¢Á∑¥Áøí", "Ê≠£ÂøµÂëºÂê∏ 3 ÂàÜÈêò"] },
        { id: "core", name: "Ê†∏ÂøÉË®ìÁ∑¥", icon: "üí™", color: "#F59E0B", bg: "#FFFBEB",
          items: ["Âπ≥ÊùøÊîØÊíê 60 Áßí", "Êç≤ËÖπ 20 ‰∏ã", "ÂÅ¥Âπ≥Êùø ÂêÑ 30 Áßí", "ËáÄÊ©ã 15 ‰∏ã"] },
        { id: "jump", name: "ÈñãÂêàË∑≥", icon: "üèÉ", color: "#10B981", bg: "#ECFDF5",
          items: ["Á¨¨ 1 Ëº™", "Á¨¨ 2 Ëº™", "Á¨¨ 3 Ëº™", "Á¨¨ 4 Ëº™", "Á¨¨ 5 Ëº™", "Á¨¨ 6 Ëº™", "Á¨¨ 7 Ëº™", "Á¨¨ 8 Ëº™"] },
        { id: "health", name: "‰øùÂÅ•ÂìÅ", icon: "üíä", color: "#EF4444", bg: "#FEF2F2",
          items: ["Á∂≠ÁîüÁ¥† D", "È≠öÊ≤π Omega-3", "ÁõäÁîüËèå", "Á∂≠ÁîüÁ¥† B Áæ§"] },
        { id: "diet", name: "È£≤È£ü", icon: "üçΩÔ∏è", color: "#3B82F6", bg: "#EFF6FF",
          items: ["ÂñùÊ∞¥ 2000ml", "Ëî¨Êûú 5 ‰ªΩ", "ËõãÁôΩË≥™ÈÅîÊ®ô"] },
    ],
    rest: [
        { id: "act", name: "Ê≠£Âøµ ACT", icon: "üß†", color: "#8B5CF6", bg: "#F3F0FF",
          items: ["Êó©Êô®ÂÜ•ÊÉ≥ 5 ÂàÜÈêò", "ACT Êé•Á¥çÁ∑¥Áøí", "ÂÉπÂÄºËßÄÂèçÊÄù", "Ë™çÁü•Ëß£Èõ¢Á∑¥Áøí", "Ê≠£ÂøµÂëºÂê∏ 3 ÂàÜÈêò"] },
        { id: "core", name: "Ê†∏ÂøÉË®ìÁ∑¥", icon: "üí™", color: "#F59E0B", bg: "#FFFBEB",
          items: ["ËºïÈáè‰º∏Â±ï", "ËáÄÊ©ã 10 ‰∏ã"] },
        { id: "jump", name: "ÈñãÂêàË∑≥", icon: "üèÉ", color: "#10B981", bg: "#ECFDF5",
          items: ["Á¨¨ 1 Ëº™", "Á¨¨ 2 Ëº™", "Á¨¨ 3 Ëº™", "Á¨¨ 4 Ëº™"] },
        { id: "health", name: "‰øùÂÅ•ÂìÅ", icon: "üíä", color: "#EF4444", bg: "#FEF2F2",
          items: ["Á∂≠ÁîüÁ¥† D", "È≠öÊ≤π Omega-3", "ÁõäÁîüËèå", "Á∂≠ÁîüÁ¥† B Áæ§", "Èà£Áâá", "ÈãÖ", "Á∂≠ÁîüÁ¥† C", "ËëâÈªÉÁ¥†", "Q10", "ËÜ†ÂéüËõãÁôΩ", "ÈêµÂäë", "Ëë°ËêÑÁ±Ω", "Â§ßËíúÁ≤æ", "ÈùàËäù", "ËñëÈªÉ"] },
        { id: "diet", name: "È£≤È£ü", icon: "üçΩÔ∏è", color: "#3B82F6", bg: "#EFF6FF",
          items: ["ÂñùÊ∞¥ 2000ml", "Ëî¨Êûú 5 ‰ªΩ", "ËõãÁôΩË≥™ÈÅîÊ®ô"] },
    ],
};

// ===== State =====
let dayType = "work";
let expanded = null;
let checked = {};

function initChecked() {
    checked = {};
    CATEGORIES[dayType].forEach(cat => {
        checked[cat.id] = new Array(cat.items.length).fill(false);
    });
}
initChecked();

// ===== Helpers =====
function getDate() {
    const d = new Date();
    const days = ["Êó•", "‰∏Ä", "‰∫å", "‰∏â", "Âõõ", "‰∫î", "ÂÖ≠"];
    return d.getFullYear() + "/" + (d.getMonth() + 1) + "/" + d.getDate() + "Ôºà" + days[d.getDay()] + "Ôºâ";
}

function getProgress() {
    const cats = CATEGORIES[dayType];
    let done = 0, total = 0;
    cats.forEach(cat => {
        total += cat.items.length;
        if (checked[cat.id]) done += checked[cat.id].filter(Boolean).length;
    });
    return { done, total, pct: total > 0 ? Math.round(done / total * 100) : 0 };
}

function getCatProgress(catId) {
    const cat = CATEGORIES[dayType].find(c => c.id === catId);
    if (!cat || !checked[catId]) return { done: 0, total: 0 };
    return { done: checked[catId].filter(Boolean).length, total: cat.items.length };
}

const CIRC = 2 * Math.PI * 72;
const CHEVRON = '<svg viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 8 10 12 14 8"/></svg>';
const TICK = '<svg viewBox="0 0 14 14" fill="none" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 7 6 10 11 4"/></svg>';

// ===== Render =====
function render() {
    const app = document.getElementById("app");
    const p = getProgress();
    const done = p.pct === 100;
    const cats = CATEGORIES[dayType];
    const off = CIRC - (p.pct / 100) * CIRC;

    let h = '';

    // Header
    h += '<div class="header">';
    h += '<div class="header-top"><span class="header-title">üìã ÂÄã‰∫∫ÈÄ≤Â∫¶ËøΩËπ§</span></div>';
    h += '<div class="date-row"><span class="date-text">' + getDate() + '</span></div>';
    h += '<div class="day-chip ' + dayType + '" onclick="toggleDay()">';
    h += dayType === "work" ? 'üíº ‰∏äÁè≠Êó•' : 'üå¥ ‰ºëÊÅØÊó•';
    h += '</div></div>';

    // Ring
    h += '<div class="progress-section"><div class="ring-container">';
    h += '<svg class="ring-svg" viewBox="0 0 180 180">';
    h += '<circle class="ring-track" cx="90" cy="90" r="72"/>';
    h += '<circle class="ring-fill' + (done ? ' complete' : '') + '" cx="90" cy="90" r="72" stroke-dasharray="' + CIRC + '" stroke-dashoffset="' + off + '"/>';
    h += '</svg><div class="ring-center">';
    h += '<div class="ring-pct' + (done ? ' complete' : '') + '">' + p.pct + '%</div>';
    h += '<div class="ring-label">' + p.done + ' / ' + p.total + ' ÂÆåÊàê</div>';
    h += '</div></div></div>';

    // Cards
    h += '<div class="cards">';
    cats.forEach(cat => {
        const cp = getCatProgress(cat.id);
        const isOpen = expanded === cat.id;
        const allDone = cp.done === cp.total && cp.total > 0;
        const pct = cp.total > 0 ? (cp.done / cp.total * 100) : 0;

        h += '<div class="card"><div class="card-header" onclick="toggleCard(\'' + cat.id + '\')">';
        h += '<div class="card-icon" style="background:' + cat.bg + '">' + cat.icon + '</div>';
        h += '<div class="card-info"><div class="card-name">' + cat.name + '</div>';
        h += '<div class="card-bar-track"><div class="card-bar-fill" style="width:' + pct + '%;background:' + cat.color + '"></div></div></div>';
        h += '<div class="card-right"><span class="card-count' + (allDone ? ' done' : '') + '">' + cp.done + '/' + cp.total + '</span>';
        h += '<div class="card-chevron' + (isOpen ? ' open' : '') + '">' + CHEVRON + '</div></div></div>';

        h += '<div class="card-body' + (isOpen ? ' open' : '') + '"><div class="checklist">';
        cat.items.forEach((item, i) => {
            const ck = checked[cat.id] && checked[cat.id][i];
            h += '<div class="check-item" onclick="toggleCheck(\'' + cat.id + '\',' + i + ')">';
            h += '<div class="check-box' + (ck ? ' checked' : '') + '" style="' + (ck ? 'background:' + cat.color : '') + '">' + TICK + '</div>';
            h += '<span class="check-text' + (ck ? ' done' : '') + '">' + item + '</span></div>';
        });
        h += '</div></div></div>';
    });
    h += '</div>';

    if (done) {
        h += '<div class="celebrate"><div class="celebrate-emoji">üéâ</div>';
        h += '<div class="celebrate-text">Â§™Ê£í‰∫ÜÔºÅ‰ªäÂ§©ÂÖ®ÈÉ®ÂÆåÊàêÔºÅ</div></div>';
    }

    app.innerHTML = h;
}

// ===== Actions =====
function toggleDay() {
    dayType = dayType === "work" ? "rest" : "work";
    initChecked();
    expanded = null;
    render();
}

function toggleCard(id) {
    expanded = expanded === id ? null : id;
    render();
    if (expanded) {
        setTimeout(() => {
            const el = document.querySelector('.card-body.open');
            if (el) el.closest('.card').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 50);
    }
}

function toggleCheck(catId, idx) {
    if (checked[catId]) checked[catId][idx] = !checked[catId][idx];
    render();
}

render();
</script>
</body>
</html>
